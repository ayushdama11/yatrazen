======================================================================================
                    COMPLETE SPRING BOOT BACKEND SETUP FOR YATRAZEN
======================================================================================

# PART 1: TERMINAL COMMANDS FOR PROJECT SETUP

## 1.1 Create Spring Boot Project Directory
mkdir backend
cd backend

## 1.2 Generate Spring Boot Project (Go to https://start.spring.io)
# Project: Maven Project
# Language: Java
# Spring Boot: 3.2.0
# Group: com.yatrazen
# Artifact: backend
# Name: yatrazen-backend
# Package name: com.yatrazen.backend
# Packaging: Jar
# Java: 17

# Dependencies to select:
# - Spring Web
# - Spring Security
# - Spring Boot DevTools
# - Validation
# - Spring Boot Actuator

## 1.3 Download and extract to backend folder

## 1.4 Add Firebase Admin SDK dependency to pom.xml
# (See pom.xml section below)

## 1.5 Run the application
./mvnw spring-boot:run
# Or on Windows:
mvnw.cmd spring-boot:run

======================================================================================
# PART 2: COMPLETE BACKEND CODE FILES
======================================================================================

## 2.1 pom.xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.2.0</version>
		<relativePath/>
	</parent>
	<groupId>com.yatrazen</groupId>
	<artifactId>backend</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>yatrazen-backend</name>
	<description>Backend for YatraZen Travel App</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-actuator</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<!-- Firebase Admin SDK -->
		<dependency>
			<groupId>com.google.firebase</groupId>
			<artifactId>firebase-admin</artifactId>
			<version>9.2.0</version>
		</dependency>
		<!-- Google HTTP Client -->
		<dependency>
			<groupId>com.google.http-client</groupId>
			<artifactId>google-http-client-jackson2</artifactId>
			<version>1.43.3</version>
		</dependency>
		<!-- JSON processing -->
		<dependency>
			<groupId>com.fasterxml.jackson.core</groupId>
			<artifactId>jackson-databind</artifactId>
		</dependency>
		<!-- Google API Client -->
		<dependency>
			<groupId>com.google.api-client</groupId>
			<artifactId>google-api-client</artifactId>
			<version>2.2.0</version>
		</dependency>
		<!-- HTTP Client for external APIs -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-webflux</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-test</artifactId>
			<scope>test</scope>
		</dependency>
	</dependencies>
	<build>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
			</plugin>
		</plugins>
	</build>
</project>

## 2.2 application.properties
server.port=8080
spring.application.name=yatrazen-backend

# Firebase Configuration
firebase.project.id=${FIREBASE_PROJECT_ID:your-firebase-project-id}
firebase.service.account.path=${FIREBASE_SERVICE_ACCOUNT_PATH:./serviceAccountKey.json}

# Google APIs
google.places.api.key=${GOOGLE_PLACES_API_KEY:your-google-places-api-key}
google.gemini.api.key=${GOOGLE_GEMINI_API_KEY:your-google-gemini-api-key}

# CORS Configuration
cors.allowed.origins=http://localhost:5173,http://localhost:3000
cors.allowed.methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed.headers=*

# Logging
logging.level.com.yatrazen=DEBUG
logging.level.org.springframework.security=DEBUG

## 2.3 Main Application Class
// src/main/java/com/yatrazen/backend/YatrazenBackendApplication.java
package com.yatrazen.backend;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class YatrazenBackendApplication {
	public static void main(String[] args) {
		SpringApplication.run(YatrazenBackendApplication.class, args);
	}
}

## 2.4 Firebase Configuration
// src/main/java/com/yatrazen/backend/config/FirebaseConfig.java
package com.yatrazen.backend.config;

import com.google.auth.oauth2.GoogleCredentials;
import com.google.firebase.FirebaseApp;
import com.google.firebase.FirebaseOptions;
import com.google.firebase.cloud.FirestoreClient;
import com.google.cloud.firestore.Firestore;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import javax.annotation.PostConstruct;
import java.io.FileInputStream;
import java.io.IOException;

@Configuration
public class FirebaseConfig {

    @Value("${firebase.service.account.path}")
    private String serviceAccountPath;

    @Value("${firebase.project.id}")
    private String projectId;

    @PostConstruct
    public void initializeFirebase() throws IOException {
        if (FirebaseApp.getApps().isEmpty()) {
            FileInputStream serviceAccount = new FileInputStream(serviceAccountPath);
            
            FirebaseOptions options = FirebaseOptions.builder()
                .setCredentials(GoogleCredentials.fromStream(serviceAccount))
                .setProjectId(projectId)
                .build();
                
            FirebaseApp.initializeApp(options);
        }
    }

    @Bean
    public Firestore firestore() {
        return FirestoreClient.getFirestore();
    }
}

## 2.5 Security Configuration
// src/main/java/com/yatrazen/backend/config/SecurityConfig.java
package com.yatrazen.backend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import java.util.Arrays;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.cors().and().csrf().disable()
            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            .and()
            .authorizeHttpRequests(authz -> authz
                .requestMatchers("/api/auth/**").permitAll()
                .requestMatchers("/api/trips/**").authenticated()
                .requestMatchers("/api/places/**").authenticated()
                .requestMatchers("/api/ai/**").authenticated()
                .anyRequest().authenticated()
            );
        return http.build();
    }

    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOriginPatterns(Arrays.asList("*"));
        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
        configuration.setAllowedHeaders(Arrays.asList("*"));
        configuration.setAllowCredentials(true);
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        return source;
    }
}

## 2.6 Trip Model Classes
// src/main/java/com/yatrazen/backend/model/Trip.java
package com.yatrazen.backend.model;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.util.List;
import java.util.Map;

public class Trip {
    private String id;
    private String userEmail;
    private UserSelection userSelection;
    private TripData tripdata;
    private Long createdAt;

    // Constructors
    public Trip() {}

    public Trip(String id, String userEmail, UserSelection userSelection, TripData tripdata, Long createdAt) {
        this.id = id;
        this.userEmail = userEmail;
        this.userSelection = userSelection;
        this.tripdata = tripdata;
        this.createdAt = createdAt;
    }

    // Getters and Setters
    public String getId() { return id; }
    public void setId(String id) { this.id = id; }

    public String getUserEmail() { return userEmail; }
    public void setUserEmail(String userEmail) { this.userEmail = userEmail; }

    public UserSelection getUserSelection() { return userSelection; }
    public void setUserSelection(UserSelection userSelection) { this.userSelection = userSelection; }

    public TripData getTripdata() { return tripdata; }
    public void setTripdata(TripData tripdata) { this.tripdata = tripdata; }

    public Long getCreatedAt() { return createdAt; }
    public void setCreatedAt(Long createdAt) { this.createdAt = createdAt; }
}

// src/main/java/com/yatrazen/backend/model/UserSelection.java
package com.yatrazen.backend.model;

public class UserSelection {
    private Location location;
    private String noOfDays;
    private String budget;
    private String traveler;

    // Constructors
    public UserSelection() {}

    // Getters and Setters
    public Location getLocation() { return location; }
    public void setLocation(Location location) { this.location = location; }

    public String getNoOfDays() { return noOfDays; }
    public void setNoOfDays(String noOfDays) { this.noOfDays = noOfDays; }

    public String getBudget() { return budget; }
    public void setBudget(String budget) { this.budget = budget; }

    public String getTraveler() { return traveler; }
    public void setTraveler(String traveler) { this.traveler = traveler; }
}

// src/main/java/com/yatrazen/backend/model/Location.java
package com.yatrazen.backend.model;

public class Location {
    private String label;
    private String value;

    // Constructors
    public Location() {}

    public Location(String label, String value) {
        this.label = label;
        this.value = value;
    }

    // Getters and Setters
    public String getLabel() { return label; }
    public void setLabel(String label) { this.label = label; }

    public String getValue() { return value; }
    public void setValue(String value) { this.value = value; }
}

// src/main/java/com/yatrazen/backend/model/TripData.java
package com.yatrazen.backend.model;

import java.util.List;

public class TripData {
    private List<Hotel> hotelOptions;
    private List<Itinerary> itinerary;

    // Constructors
    public TripData() {}

    // Getters and Setters
    public List<Hotel> getHotelOptions() { return hotelOptions; }
    public void setHotelOptions(List<Hotel> hotelOptions) { this.hotelOptions = hotelOptions; }

    public List<Itinerary> getItinerary() { return itinerary; }
    public void setItinerary(List<Itinerary> itinerary) { this.itinerary = itinerary; }
}

// src/main/java/com/yatrazen/backend/model/Hotel.java
package com.yatrazen.backend.model;

public class Hotel {
    private String hotelName;
    private String hotelAddress;
    private String price;
    private String hotelImageUrl;
    private GeoCoordinates geoCoordinates;
    private Double rating;
    private String description;

    // Constructors
    public Hotel() {}

    // Getters and Setters
    public String getHotelName() { return hotelName; }
    public void setHotelName(String hotelName) { this.hotelName = hotelName; }

    public String getHotelAddress() { return hotelAddress; }
    public void setHotelAddress(String hotelAddress) { this.hotelAddress = hotelAddress; }

    public String getPrice() { return price; }
    public void setPrice(String price) { this.price = price; }

    public String getHotelImageUrl() { return hotelImageUrl; }
    public void setHotelImageUrl(String hotelImageUrl) { this.hotelImageUrl = hotelImageUrl; }

    public GeoCoordinates getGeoCoordinates() { return geoCoordinates; }
    public void setGeoCoordinates(GeoCoordinates geoCoordinates) { this.geoCoordinates = geoCoordinates; }

    public Double getRating() { return rating; }
    public void setRating(Double rating) { this.rating = rating; }

    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }
}

// src/main/java/com/yatrazen/backend/model/Itinerary.java
package com.yatrazen.backend.model;

import java.util.List;

public class Itinerary {
    private Integer day;
    private List<Place> places;

    // Constructors
    public Itinerary() {}

    // Getters and Setters
    public Integer getDay() { return day; }
    public void setDay(Integer day) { this.day = day; }

    public List<Place> getPlaces() { return places; }
    public void setPlaces(List<Place> places) { this.places = places; }
}

// src/main/java/com/yatrazen/backend/model/Place.java
package com.yatrazen.backend.model;

public class Place {
    private String placeName;
    private String placeDetails;
    private String placeImageUrl;
    private GeoCoordinates geoCoordinates;
    private String ticketPricing;
    private Double rating;
    private String travelTime;
    private String bestTimeSlotToVisit;
    private String timeToTravel;

    // Constructors
    public Place() {}

    // Getters and Setters (all fields)
    public String getPlaceName() { return placeName; }
    public void setPlaceName(String placeName) { this.placeName = placeName; }

    public String getPlaceDetails() { return placeDetails; }
    public void setPlaceDetails(String placeDetails) { this.placeDetails = placeDetails; }

    public String getPlaceImageUrl() { return placeImageUrl; }
    public void setPlaceImageUrl(String placeImageUrl) { this.placeImageUrl = placeImageUrl; }

    public GeoCoordinates getGeoCoordinates() { return geoCoordinates; }
    public void setGeoCoordinates(GeoCoordinates geoCoordinates) { this.geoCoordinates = geoCoordinates; }

    public String getTicketPricing() { return ticketPricing; }
    public void setTicketPricing(String ticketPricing) { this.ticketPricing = ticketPricing; }

    public Double getRating() { return rating; }
    public void setRating(Double rating) { this.rating = rating; }

    public String getTravelTime() { return travelTime; }
    public void setTravelTime(String travelTime) { this.travelTime = travelTime; }

    public String getBestTimeSlotToVisit() { return bestTimeSlotToVisit; }
    public void setBestTimeSlotToVisit(String bestTimeSlotToVisit) { this.bestTimeSlotToVisit = bestTimeSlotToVisit; }

    public String getTimeToTravel() { return timeToTravel; }
    public void setTimeToTravel(String timeToTravel) { this.timeToTravel = timeToTravel; }
}

// src/main/java/com/yatrazen/backend/model/GeoCoordinates.java
package com.yatrazen.backend.model;

public class GeoCoordinates {
    private Double latitude;
    private Double longitude;

    // Constructors
    public GeoCoordinates() {}

    public GeoCoordinates(Double latitude, Double longitude) {
        this.latitude = latitude;
        this.longitude = longitude;
    }

    // Getters and Setters
    public Double getLatitude() { return latitude; }
    public void setLatitude(Double latitude) { this.latitude = latitude; }

    public Double getLongitude() { return longitude; }
    public void setLongitude(Double longitude) { this.longitude = longitude; }
}

## 2.7 DTOs (Data Transfer Objects)
// src/main/java/com/yatrazen/backend/dto/CreateTripRequest.java
package com.yatrazen.backend.dto;

import com.yatrazen.backend.model.UserSelection;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Email;

public class CreateTripRequest {
    @NotNull
    @Email
    private String userEmail;
    
    @NotNull
    private UserSelection userSelection;

    // Constructors
    public CreateTripRequest() {}

    // Getters and Setters
    public String getUserEmail() { return userEmail; }
    public void setUserEmail(String userEmail) { this.userEmail = userEmail; }

    public UserSelection getUserSelection() { return userSelection; }
    public void setUserSelection(UserSelection userSelection) { this.userSelection = userSelection; }
}

// src/main/java/com/yatrazen/backend/dto/PlaceSearchRequest.java
package com.yatrazen.backend.dto;

public class PlaceSearchRequest {
    private String textQuery;

    // Constructors
    public PlaceSearchRequest() {}

    public PlaceSearchRequest(String textQuery) {
        this.textQuery = textQuery;
    }

    // Getters and Setters
    public String getTextQuery() { return textQuery; }
    public void setTextQuery(String textQuery) { this.textQuery = textQuery; }
}

## 2.8 Services
// src/main/java/com/yatrazen/backend/service/FirebaseService.java
package com.yatrazen.backend.service;

import com.google.cloud.firestore.*;
import com.yatrazen.backend.model.Trip;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import java.util.List;
import java.util.ArrayList;
import java.util.concurrent.ExecutionException;

@Service
public class FirebaseService {

    @Autowired
    private Firestore firestore;

    private static final String COLLECTION_NAME = "AITrips";

    public Trip saveTrip(Trip trip) throws ExecutionException, InterruptedException {
        DocumentReference docRef = firestore.collection(COLLECTION_NAME).document(trip.getId());
        ApiFuture<WriteResult> result = docRef.set(trip);
        result.get(); // Wait for the operation to complete
        return trip;
    }

    public Trip getTripById(String tripId) throws ExecutionException, InterruptedException {
        DocumentReference docRef = firestore.collection(COLLECTION_NAME).document(tripId);
        ApiFuture<DocumentSnapshot> future = docRef.get();
        DocumentSnapshot document = future.get();
        
        if (document.exists()) {
            return document.toObject(Trip.class);
        }
        return null;
    }

    public List<Trip> getTripsByUserEmail(String userEmail) throws ExecutionException, InterruptedException {
        CollectionReference trips = firestore.collection(COLLECTION_NAME);
        Query query = trips.whereEqualTo("userEmail", userEmail);
        ApiFuture<QuerySnapshot> querySnapshot = query.get();
        
        List<Trip> tripList = new ArrayList<>();
        for (DocumentSnapshot document : querySnapshot.get().getDocuments()) {
            tripList.add(document.toObject(Trip.class));
        }
        return tripList;
    }

    public boolean deleteTrip(String tripId) throws ExecutionException, InterruptedException {
        DocumentReference docRef = firestore.collection(COLLECTION_NAME).document(tripId);
        ApiFuture<WriteResult> result = docRef.delete();
        result.get(); // Wait for the operation to complete
        return true;
    }
}

// src/main/java/com/yatrazen/backend/service/GooglePlacesService.java
package com.yatrazen.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.core.publisher.Mono;
import java.util.Map;
import java.util.HashMap;

@Service
public class GooglePlacesService {

    @Value("${google.places.api.key}")
    private String apiKey;

    private final WebClient webClient;
    private static final String PLACES_API_URL = "https://places.googleapis.com/v1/places:searchText";

    public GooglePlacesService() {
        this.webClient = WebClient.builder()
            .baseUrl(PLACES_API_URL)
            .build();
    }

    public Mono<String> searchPlaces(String textQuery) {
        Map<String, String> requestBody = new HashMap<>();
        requestBody.put("textQuery", textQuery);

        return webClient.post()
            .header("Content-Type", "application/json")
            .header("X-Goog-Api-Key", apiKey)
            .header("X-Goog-FieldMask", "places.photos,places.displayName,places.id")
            .bodyValue(requestBody)
            .retrieve()
            .bodyToMono(String.class);
    }

    public String getPhotoUrl(String photoName) {
        return "https://places.googleapis.com/v1/" + photoName + "/media?maxHeightPx=1000&maxWidthPx=1000&key=" + apiKey;
    }
}

// src/main/java/com/yatrazen/backend/service/GeminiAIService.java
package com.yatrazen.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.core.publisher.Mono;
import java.util.Map;
import java.util.HashMap;
import java.util.List;
import java.util.Arrays;

@Service
public class GeminiAIService {

    @Value("${google.gemini.api.key}")
    private String apiKey;

    private final WebClient webClient;
    private static final String GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent";

    public GeminiAIService() {
        this.webClient = WebClient.builder().build();
    }

    public Mono<String> generateTripPlan(String prompt) {
        Map<String, Object> requestBody = new HashMap<>();
        Map<String, Object> generationConfig = new HashMap<>();
        generationConfig.put("temperature", 1);
        generationConfig.put("topP", 0.95);
        generationConfig.put("topK", 40);
        generationConfig.put("maxOutputTokens", 8192);
        generationConfig.put("responseMimeType", "application/json");

        Map<String, Object> content = new HashMap<>();
        Map<String, Object> part = new HashMap<>();
        part.put("text", prompt);
        content.put("parts", Arrays.asList(part));

        requestBody.put("contents", Arrays.asList(content));
        requestBody.put("generationConfig", generationConfig);

        String url = GEMINI_API_URL + "?key=" + apiKey;

        return webClient.post()
            .uri(url)
            .header("Content-Type", "application/json")
            .bodyValue(requestBody)
            .retrieve()
            .bodyToMono(String.class);
    }
}

// src/main/java/com/yatrazen/backend/service/TripService.java
package com.yatrazen.backend.service;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.yatrazen.backend.dto.CreateTripRequest;
import com.yatrazen.backend.model.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import java.util.List;
import java.util.concurrent.ExecutionException;

@Service
public class TripService {

    @Autowired
    private FirebaseService firebaseService;

    @Autowired
    private GeminiAIService geminiAIService;

    private final ObjectMapper objectMapper = new ObjectMapper();

    private static final String AI_PROMPT = """
        Generate a Travel Plan for Location: {location}, for {totalDays} Days for {traveler} with a {budget} budget.

        Provide the response in JSON format with the following structure: 
        {
          "hotelOptions": [ -- minimum 4 hotels neccesary
            {
              "hotelName": "string",
              "hotelAddress": "string",
              "price": "number",
              "hotelImageUrl": "string",
              "geoCoordinates": { "latitude": "number", "longitude": "number" },
              "rating": "number",
              "description": "string"
            }
          ],
          "itinerary": [
            {
              "day": "number",
              "places": [
                {
                  "placeName": "string",
                  "placeDetails": "string",
                  "placeImageUrl": "string",
                  "geoCoordinates": { "latitude": "number", "longitude": "number" },
                  "ticketPricing": "string",
                  "rating": "number",
                  "travelTime": "string",
                  "bestTimeSlotToVisit": "string",
                  "timeToTravel": "string"
                }
              ]
            }
          ]
        }
        Ensure "itinerary" is always an array containing "day" keys, with each day's "places" as an array.
        """;

    public Trip createTrip(CreateTripRequest request) throws Exception {
        // Generate AI prompt
        String prompt = AI_PROMPT
            .replace("{location}", request.getUserSelection().getLocation().getLabel())
            .replace("{totalDays}", request.getUserSelection().getNoOfDays())
            .replace("{traveler}", request.getUserSelection().getTraveler())
            .replace("{budget}", request.getUserSelection().getBudget());

        // Generate trip data using Gemini AI
        String aiResponse = geminiAIService.generateTripPlan(prompt).block();
        
        // Parse AI response
        JsonNode responseJson = objectMapper.readTree(aiResponse);
        String tripDataJson = responseJson.get("candidates").get(0).get("content").get("parts").get(0).get("text").asText();
        
        TripData tripData = objectMapper.readValue(tripDataJson, TripData.class);

        // Create trip object
        String tripId = String.valueOf(System.currentTimeMillis());
        Trip trip = new Trip();
        trip.setId(tripId);
        trip.setUserEmail(request.getUserEmail());
        trip.setUserSelection(request.getUserSelection());
        trip.setTripdata(tripData);
        trip.setCreatedAt(System.currentTimeMillis());

        // Save to Firebase
        return firebaseService.saveTrip(trip);
    }

    public Trip getTripById(String tripId) throws ExecutionException, InterruptedException {
        return firebaseService.getTripById(tripId);
    }

    public List<Trip> getUserTrips(String userEmail) throws ExecutionException, InterruptedException {
        return firebaseService.getTripsByUserEmail(userEmail);
    }

    public boolean deleteTrip(String tripId) throws ExecutionException, InterruptedException {
        return firebaseService.deleteTrip(tripId);
    }
}

## 2.9 Controllers
// src/main/java/com/yatrazen/backend/controller/AuthController.java
package com.yatrazen.backend.controller;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import java.util.Map;
import java.util.HashMap;

@RestController
@RequestMapping("/api/auth")
public class AuthController {

    @PostMapping("/verify-token")
    public ResponseEntity<Map<String, Object>> verifyToken(@RequestBody Map<String, String> request) {
        String token = request.get("token");
        // Here you would verify the Google OAuth token
        // For now, returning a simple response
        
        Map<String, Object> response = new HashMap<>();
        response.put("valid", true);
        response.put("message", "Token verified successfully");
        
        return ResponseEntity.ok(response);
    }

    @GetMapping("/user")
    public ResponseEntity<Map<String, Object>> getCurrentUser(@RequestHeader("Authorization") String authHeader) {
        // Extract user info from token
        // For now, returning mock data
        
        Map<String, Object> user = new HashMap<>();
        user.put("email", "user@example.com");
        user.put("name", "John Doe");
        user.put("picture", "https://example.com/avatar.jpg");
        
        return ResponseEntity.ok(user);
    }
}

// src/main/java/com/yatrazen/backend/controller/TripController.java
package com.yatrazen.backend.controller;

import com.yatrazen.backend.dto.CreateTripRequest;
import com.yatrazen.backend.model.Trip;
import com.yatrazen.backend.service.TripService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import javax.validation.Valid;
import java.util.List;
import java.util.concurrent.ExecutionException;

@RestController
@RequestMapping("/api/trips")
public class TripController {

    @Autowired
    private TripService tripService;

    @PostMapping
    public ResponseEntity<Trip> createTrip(@Valid @RequestBody CreateTripRequest request) {
        try {
            Trip trip = tripService.createTrip(request);
            return ResponseEntity.ok(trip);
        } catch (Exception e) {
            e.printStackTrace();
            return ResponseEntity.internalServerError().build();
        }
    }

    @GetMapping("/{tripId}")
    public ResponseEntity<Trip> getTripById(@PathVariable String tripId) {
        try {
            Trip trip = tripService.getTripById(tripId);
            if (trip != null) {
                return ResponseEntity.ok(trip);
            }
            return ResponseEntity.notFound().build();
        } catch (ExecutionException | InterruptedException e) {
            e.printStackTrace();
            return ResponseEntity.internalServerError().build();
        }
    }

    @GetMapping("/user/{userEmail}")
    public ResponseEntity<List<Trip>> getUserTrips(@PathVariable String userEmail) {
        try {
            List<Trip> trips = tripService.getUserTrips(userEmail);
            return ResponseEntity.ok(trips);
        } catch (ExecutionException | InterruptedException e) {
            e.printStackTrace();
            return ResponseEntity.internalServerError().build();
        }
    }

    @DeleteMapping("/{tripId}")
    public ResponseEntity<Void> deleteTrip(@PathVariable String tripId) {
        try {
            boolean deleted = tripService.deleteTrip(tripId);
            if (deleted) {
                return ResponseEntity.ok().build();
            }
            return ResponseEntity.notFound().build();
        } catch (ExecutionException | InterruptedException e) {
            e.printStackTrace();
            return ResponseEntity.internalServerError().build();
        }
    }
}

// src/main/java/com/yatrazen/backend/controller/PlacesController.java
package com.yatrazen.backend.controller;

import com.yatrazen.backend.dto.PlaceSearchRequest;
import com.yatrazen.backend.service.GooglePlacesService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import reactor.core.publisher.Mono;

@RestController
@RequestMapping("/api/places")
public class PlacesController {

    @Autowired
    private GooglePlacesService googlePlacesService;

    @PostMapping("/search")
    public Mono<ResponseEntity<String>> searchPlaces(@RequestBody PlaceSearchRequest request) {
        return googlePlacesService.searchPlaces(request.getTextQuery())
            .map(ResponseEntity::ok)
            .defaultIfEmpty(ResponseEntity.notFound().build());
    }

    @GetMapping("/photo")
    public ResponseEntity<String> getPhotoUrl(@RequestParam String photoName) {
        String photoUrl = googlePlacesService.getPhotoUrl(photoName);
        return ResponseEntity.ok(photoUrl);
    }
}

======================================================================================
# PART 3: FRONTEND INTEGRATION CHANGES
======================================================================================

## 3.1 Update package.json (add axios if not present)
# Already present in your project

## 3.2 Create Backend API Service
// src/service/BackendApi.jsx
import axios from 'axios';

const BASE_URL = 'http://localhost:8080/api';

// Create axios instance with default config
const apiClient = axios.create({
  baseURL: BASE_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Add request interceptor to include auth token
apiClient.interceptors.request.use((config) => {
  const user = JSON.parse(localStorage.getItem('user') || '{}');
  if (user?.access_token) {
    config.headers.Authorization = `Bearer ${user.access_token}`;
  }
  return config;
});

// Trip API functions
export const createTrip = async (tripData) => {
  const response = await apiClient.post('/trips', tripData);
  return response.data;
};

export const getTripById = async (tripId) => {
  const response = await apiClient.get(`/trips/${tripId}`);
  return response.data;
};

export const getUserTrips = async (userEmail) => {
  const response = await apiClient.get(`/trips/user/${encodeURIComponent(userEmail)}`);
  return response.data;
};

export const deleteTrip = async (tripId) => {
  const response = await apiClient.delete(`/trips/${tripId}`);
  return response.data;
};

// Places API functions
export const searchPlaces = async (textQuery) => {
  const response = await apiClient.post('/places/search', { textQuery });
  return response.data;
};

// Auth API functions
export const verifyToken = async (token) => {
  const response = await apiClient.post('/auth/verify-token', { token });
  return response.data;
};

## 3.3 Update Create Trip Component
// Update src/create-trip/index.jsx
// Replace the SaveAiTrip function with this:

const SaveAiTrip = async(TripData) => {
  setLoading(true);
  const user = JSON.parse(localStorage.getItem('user'));
  
  try {
    // Parse the AI response
    const parsedTripData = JSON.parse(TripData);
    
    // Create request object for backend
    const createTripRequest = {
      userEmail: user?.email,
      userSelection: formData,
      tripData: parsedTripData
    };

    // Call backend API instead of direct Firebase
    const savedTrip = await createTrip(createTripRequest);
    
    setLoading(false);
    navigate('/view-trip/' + savedTrip.id);
    
  } catch (error) {
    console.error('Error saving trip:', error);
    setLoading(false);
    toast('Error saving trip. Please try again.');
  }
}

// Also add import at the top:
import { createTrip } from '../service/BackendApi';

## 3.4 Update My Trips Component
// Update src/my-trips/index.jsx
// Replace the GetUserTrips function:

import { getUserTrips } from '../service/BackendApi';

const GetUserTrips = async () => {
  const user = JSON.parse(localStorage.getItem('user'));
  if (!user) {
    navigate('/');
    return;
  }

  try {
    const trips = await getUserTrips(user.email);
    setUserTrips(trips);
  } catch (error) {
    console.error("Error fetching trips:", error);
    toast('Error loading trips. Please try again.');
  }
};

## 3.5 Update View Trip Component
// Update src/view-trip/[tripId]/index.jsx
// Replace the GetTripData function:

import { getTripById } from '../../service/BackendApi';

const GetTripData = async() => {
  try {
    const tripData = await getTripById(tripId);
    if (tripData) {
      console.log("Trip data:", tripData);
      setTrip(tripData);
    } else {
      console.log("No trip found");
      toast('No trip found');
    }
  } catch (error) {
    console.error("Error fetching trip:", error);
    toast('Error loading trip. Please try again.');
  }
}

## 3.6 Update Environment Variables
// Create .env file in frontend root (if not exists)
VITE_BACKEND_URL=http://localhost:8080
VITE_FIREBASE_API_KEY=your_firebase_api_key
VITE_FIREBASE_AUTH_DOMAIN=your_firebase_auth_domain
VITE_FIREBASE_PROJECT_ID=your_firebase_project_id
VITE_FIREBASE_STORAGE_BUCKET=your_firebase_storage_bucket
VITE_FIREBASE_MESSAGING_SENDER_ID=your_firebase_messaging_sender_id
VITE_FIREBASE_APP_ID=your_firebase_app_id
VITE_FIREBASE_MEASUREMENT_ID=your_firebase_measurement_id
VITE_GOOGLE_PLACE_API_KEY=your_google_places_api_key
VITE_GOOGLE_GEMINI_AI_API_KEY=your_google_gemini_api_key

======================================================================================
# PART 4: DEPLOYMENT AND TESTING
======================================================================================

## 4.1 Backend Environment Setup
# Create application-prod.properties for production
server.port=${PORT:8080}
spring.application.name=yatrazen-backend

# Firebase Configuration
firebase.project.id=${FIREBASE_PROJECT_ID}
firebase.service.account.path=${FIREBASE_SERVICE_ACCOUNT_PATH}

# Google APIs
google.places.api.key=${GOOGLE_PLACES_API_KEY}
google.gemini.api.key=${GOOGLE_GEMINI_API_KEY}

# CORS Configuration
cors.allowed.origins=${CORS_ALLOWED_ORIGINS:http://localhost:5173}

## 4.2 Testing Commands
# Backend testing
cd backend
./mvnw test

# Frontend testing  
cd ..
npm run build
npm run preview

## 4.3 Docker Configuration (Optional)
# Dockerfile for backend
FROM openjdk:17-jdk-slim
VOLUME /tmp
COPY target/*.jar app.jar
ENTRYPOINT ["java","-jar","/app.jar"]

# Build command
./mvnw clean package
docker build -t yatrazen-backend .
docker run -p 8080:8080 yatrazen-backend

======================================================================================
# PART 5: KEY INTEGRATION POINTS
======================================================================================

## 5.1 Authentication Flow
1. Frontend: User logs in with Google OAuth
2. Frontend: Stores user info in localStorage
3. Frontend: Includes user email in API requests
4. Backend: Validates requests and processes data
5. Backend: Stores data in Firebase Firestore

## 5.2 Data Flow
1. Create Trip: Frontend → Backend → Gemini AI → Firebase → Frontend
2. View Trips: Frontend → Backend → Firebase → Frontend
3. View Trip: Frontend → Backend → Firebase → Frontend

## 5.3 Error Handling
- Backend returns standard HTTP status codes
- Frontend handles errors with toast notifications
- Proper validation on both frontend and backend

## 5.4 Security Considerations
- CORS configured for frontend domain
- Input validation on all endpoints
- Firebase security rules still apply
- OAuth token validation (implement as needed)

======================================================================================
# PART 6: NEXT STEPS AND ENHANCEMENTS
======================================================================================

## 6.1 Additional Features to Implement
- User profile management
- Trip sharing functionality
- Trip reviews and ratings
- Payment integration for bookings
- Real-time notifications
- Mobile app support
- Advanced trip analytics

## 6.2 Performance Optimizations
- Implement caching (Redis)
- Add database indexing
- Implement rate limiting
- Add API documentation (Swagger)
- Add monitoring and logging

## 6.3 Production Deployment
- Set up CI/CD pipeline
- Configure production databases
- Set up monitoring and alerting
- Implement backup strategies
- Security hardening

======================================================================================

This complete setup integrates Spring Boot backend with your existing React + Firebase frontend, maintaining all your current functionality while adding the power and flexibility of a Java backend. The backend handles business logic, AI integration, and data management while your frontend remains largely unchanged.